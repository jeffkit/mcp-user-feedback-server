# MCP 用户反馈服务器 - 使用指南

## 概述

MCP 用户反馈服务器允许 AI 助手通过原生系统对话框请求用户的实时输入。这在 AI 需要澄清、偏好或原始对话中未提供的特定信息时特别有用。

## 安装和设置

### 1. Cursor IDE 设置

1. 打开 Cursor IDE
2. 进入设置 (Cmd/Ctrl + ,)
3. 搜索 "MCP" 或导航到 MCP 服务器部分
4. 添加以下配置：

```json
{
  "mcpServers": {
    "user-feedback": {
      "command": "npx",
      "args": [
        "-y",
        "mcp-user-feedback-server@latest"
      ]
    }
  }
}
```

5. 重启 Cursor IDE

### 2. Claude Desktop 设置

1. 打开 Claude Desktop 配置文件：
   - **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
   - **Windows**: `%APPDATA%\\Claude\\claude_desktop_config.json`

2. 添加服务器配置：

```json
{
  "mcpServers": {
    "user-feedback": {
      "command": "npx",
      "args": [
        "-y",
        "mcp-user-feedback-server@latest"
      ]
    }
  }
}
```

3. 重启 Claude Desktop

### 3. 其他 MCP 客户端

对于任何其他 MCP 兼容的客户端，使用：
- **命令**: `npx`
- **参数**: `["-y", "mcp-user-feedback-server@latest"]`

## 工作原理

配置后，AI 助手获得对 `request_user_feedback` 工具的访问权限，该工具可以：

1. 在您的屏幕上显示原生对话框
2. 显示自定义问题或提示
3. 接受用户输入
4. 将输入返回给 AI

## 使用场景

### 1. 澄清需求

```
用户: 为我的业务创建一个网站
AI: 我想了解一些关于您业务的详细信息，以便为您创建最佳的网站。
[AI 显示对话框: "您从事什么类型的业务？"]
[您输入: "专门制作定制蛋糕的本地面包店"]
AI: 完美！我将为您的定制蛋糕面包店创建一个网站设计...
```

### 2. 获取偏好

```
用户: 帮我选择配色方案
AI: 让我询问您的颜色偏好。
[AI 显示标题为"颜色偏好"的对话框: "您最喜欢的颜色是什么，或者有什么颜色您想避免的吗？"]
[您输入: "我喜欢蓝色和绿色，避免红色"]
AI: 很好的选择！这里有一些蓝色和绿色的配色方案...
```

### 3. 收集敏感信息

```
用户: 设置我的数据库连接
AI: 我需要您的数据库凭据来帮助您进行设置。
[AI 显示对话框: "请输入您的数据库密码:"]
[您安全地输入密码]
AI: 谢谢！我将使用您的凭据配置连接...
```

### 4. 交互式决策制定

```
用户: 帮我重构这段代码
AI: 我看到几种不同的方法。让我询问您更喜欢哪种。
[AI 显示对话框: "您更喜欢：A) 性能优化，B) 可读性焦点，还是 C) 可维护性焦点？"]
[您选择: "B) 可读性焦点"]
AI: 我将专注于可读性进行重构...
```

## 对话框功能

### 基本对话框
- 简单文本输入
- 确定/取消按钮
- 返回用户输入或取消时的错误

### 高级选项
- **自定义标题**: 为对话框设置特定标题
- **默认文本**: 预填输入字段
- **多平台**: 在 macOS、Windows 和 Linux 上工作

## 平台特定行为

### macOS
- 使用原生 AppleScript 对话框
- 与系统外观集成
- 无需额外软件

### Windows
- 使用 VBScript InputBox
- 原生 Windows 外观和感觉
- 无需额外软件

### Linux
- 使用 `zenity` (GTK) 或 `kdialog` (KDE)
- 可能需要安装对话框软件：
  ```bash
  # Ubuntu/Debian
  sudo apt-get install zenity
  
  # 或者对于 KDE
  sudo apt-get install kdialog
  ```

## 故障排除

### 对话框不出现
1. **检查服务器是否运行**: MCP 客户端应显示服务器已连接
2. **GUI 环境**: 确保您在图形环境中（不是没有 X11 的 SSH）
3. **Linux 依赖**: 在 Linux 系统上安装 `zenity` 或 `kdialog`

### 权限问题
- **macOS**: 您可能需要向终端或 MCP 客户端授予辅助功能权限
- **Windows**: 确保脚本可以运行（如需要，检查执行策略）

### AI 不使用工具
- AI 只会在确定需要用户输入时使用该工具
- 您可以明确要求："请向我询问[特定信息]"
- 确保 MCP 服务器已正确配置并连接

## 对话流程示例

### 信息收集
```
用户: 帮我写一封专业邮件
AI: 我将帮助您写一封专业邮件。让我先收集一些详细信息。
[对话框 1: "这封邮件的收件人是谁？"]
[对话框 2: "邮件的主要目的或主题是什么？"]
[对话框 3: "您希望使用什么语调？（正式、友好、紧急等）"]
AI: 根据您的输入，这是一份专业邮件草稿...
```

### 配置设置
```
用户: 设置我的开发环境
AI: 我将帮助您配置开发环境。让我问几个问题。
[对话框 1: "您主要使用什么编程语言/框架？"]
[对话框 2: "您更喜欢 VS Code、IntelliJ 还是其他 IDE？"]
[对话框 3: "有什么特定工具或扩展您经常使用的吗？"]
AI: 这是您的定制开发环境设置...
```

## 隐私和安全

- 用户输入只发送给 AI 助手，不会被 MCP 服务器存储
- 敏感信息应由用户和 AI 谨慎处理
- 对话框在您的机器本地出现 - 在您提交之前不会传输数据
- 您始终可以取消对话框而不提供信息

## 最佳体验提示

1. **具体说明**: 当要求 AI 收集信息时，要具体说明您需要什么
2. **使用标题**: AI 可以为对话框设置有意义的标题以提供上下文
3. **默认值**: 对于表单或重复任务，默认值可以加快过程
4. **多个问题**: AI 可以为复杂任务按顺序问几个问题

## 需要帮助？

如果您遇到问题：
1. 检查 [TEST_GUIDE.md](TEST_GUIDE.md) 中的测试说明
2. 验证您的 MCP 客户端配置
3. 确保平台依赖已安装
4. 检查控制台输出中的错误消息 